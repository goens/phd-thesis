\begin{scope}[name prefix=orig-]
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe1) at (1,1) {\Huge PE$_1$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe2) at (1,5) {\Huge PE$_2$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe3) at (1,9) {\Huge PE$_3$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe4) at (1,13) {\Huge PE$_4$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe5) at (5,1) {\Huge PE$_5$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe6) at (5,5) {\Huge PE$_6$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe7) at (5,9) {\Huge PE$_7$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe8) at (5,13) {\Huge PE$_8$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe9) at (9,1) {\Huge PE$_9$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe10) at (9,5) {\Huge PE$_{10}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe11) at (9,9) {\Huge PE$_{11}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe12) at (9,13) {\Huge PE$_{12}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe13) at (13,1) {\Huge PE$_{13}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe14) at (13,5) {\Huge PE$_{14}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe15) at (13,9) {\Huge PE$_{15}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe16) at (13,13) {\Huge PE$_{16}$};
  \foreach \x in {0,...,3}{
    \foreach \y in {0,...,3}{
       \pgfmathsetmacro{\xn}{\x*4}
       \pgfmathsetmacro{\yn}{\y*4} 
       \draw[opacity=0.3] ({\xn + 2}, {\yn + 2}) -- ++(0.5,0.5);
       \draw[opacity=0.3] ({\xn + 2.5},{\yn + 2.5}) rectangle ++(1,1) ++(-0.5,-0.5) node[font=\Large,opacity=0.3] {R};
      \ifnum\x<2
      \ifnum\y<2
       \draw ({\xn + 2}, {\yn + 2}) -- ++(0.5,0.5);
       \draw ({\xn + 2.5},{\yn + 2.5}) rectangle ++(1,1) ++(-0.5,-0.5) node[font=\Large] {R};
       \fi
       \fi

      }
    }

  \foreach \x in {0,...,3}{
    \foreach \y in {0,...,3}{
      \pgfmathsetmacro{\xs}{\x*4+3}
      \pgfmathsetmacro{\ys}{\y*4+3}
      \pgfmathsetmacro{\xn}{\xs+3}
      \pgfmathsetmacro{\yn}{\ys+3}
      \pgfmathsetmacro{\xsm}{\x*4+3.5}
      \pgfmathsetmacro{\ysm}{\y*4+3.5}
      \pgfmathsetmacro{\xnm}{\xsm+3}
      \pgfmathsetmacro{\ynm}{\ysm+3}

      \ifnum\x<3
      \path[<->,very thick,blue!55,opacity=0.3] (\xsm,\ys) edge (\xnm,\ys);
      \fi
      \ifnum\y<3
      \path[<->,very thick,blue!55,opacity=0.3] (\xs,\ysm) edge (\xs,\ynm);
      \fi

      \ifnum\x<1
      \ifnum\y<2
      \path[<->,very thick,blue!55] (\xsm,\ys) edge (\xnm,\ys);
       \fi
       \fi
      \ifnum\y<1
      \ifnum\x<2
      \path[<->,very thick,blue!55] (\xs,\ysm) edge (\xs,\ynm);
       \fi
       \fi
      
      }
    }

\end{scope}

\begin{scope}[xshift=600,name prefix=transformed-]
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe5) at (1,1) {\Huge PE$_5$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe1) at (1,5) {\Huge PE$_1$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe3) at (1,9) {\Huge PE$_3$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe4) at (1,13) {\Huge PE$_4$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe6) at (5,1) {\Huge PE$_6$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=green!30] (pe2) at (5,5) {\Huge PE$_2$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe7) at (5,9) {\Huge PE$_7$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe8) at (5,13) {\Huge PE$_8$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe9) at (9,1) {\Huge PE$_9$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe10) at (9,5) {\Huge PE$_{10}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe11) at (9,9) {\Huge PE$_{11}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe12) at (9,13) {\Huge PE$_{12}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe13) at (13,1) {\Huge PE$_{13}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe14) at (13,5) {\Huge PE$_{14}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe15) at (13,9) {\Huge PE$_{15}$};
  \node[rectangle,thick,minimum width = 2cm, minimum height=2cm,fill=gray!60,opacity=0.3] (pe16) at (13,13) {\Huge PE$_{16}$};
  \foreach \x in {0,...,3}{
    \foreach \y in {0,...,3}{
       \pgfmathsetmacro{\xn}{\x*4}
       \pgfmathsetmacro{\yn}{\y*4} 
       \draw[opacity=0.3] ({\xn + 2}, {\yn + 2}) -- ++(0.5,0.5);
       \draw[opacity=0.3] ({\xn + 2.5},{\yn + 2.5}) rectangle ++(1,1) ++(-0.5,-0.5) node[font=\Large,opacity=0.3] {R};
      \ifnum\x<2
      \ifnum\y<2
       \draw ({\xn + 2}, {\yn + 2}) -- ++(0.5,0.5);
       \draw ({\xn + 2.5},{\yn + 2.5}) rectangle ++(1,1) ++(-0.5,-0.5) node[font=\Large] {R};
       \fi
       \fi
      }
    }

  \foreach \x in {0,...,3}{
    \foreach \y in {0,...,3}{
      \pgfmathsetmacro{\xs}{\x*4+3}
      \pgfmathsetmacro{\ys}{\y*4+3}
      \pgfmathsetmacro{\xn}{\xs+3}
      \pgfmathsetmacro{\yn}{\ys+3}
      \pgfmathsetmacro{\xsm}{\x*4+3.5}
      \pgfmathsetmacro{\ysm}{\y*4+3.5}
      \pgfmathsetmacro{\xnm}{\xsm+3}
      \pgfmathsetmacro{\ynm}{\ysm+3}

      \ifnum\x<3
      \path[<->,very thick,blue!55,opacity=0.3] (\xsm,\ys) edge (\xnm,\ys);
      \fi
      \ifnum\y<3
      \path[<->,very thick,blue!55,opacity=0.3] (\xs,\ysm) edge (\xs,\ynm);
      \fi

      \ifnum\x<1
      \ifnum\y<2
      \path[<->,very thick,blue!55] (\xsm,\ys) edge (\xnm,\ys);
       \fi
       \fi
      \ifnum\y<1
      \ifnum\x<2
      \path[<->,very thick,blue!55] (\xs,\ysm) edge (\xs,\ynm);
       \fi
       \fi
      
      }
    }

\end{scope}

\draw (orig-pe2) edge[-{latex},line width=2.2mm, color=red!60,in=210,out=340,looseness=1]  (transformed-pe2);
\draw (orig-pe5) edge[-{latex},line width=2.2mm, color=red!60,in=210,out=340,looseness=1]  (transformed-pe5);
\draw (orig-pe6) edge[-{latex},line width=2.2mm, color=red!60,in=210,out=340,looseness=1]  (transformed-pe6);
\draw (orig-pe1) edge[-{latex},line width=2.2mm, color=red!60,in=210,out=340,looseness=1]  (transformed-pe1);