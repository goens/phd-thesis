library(sets)
library(tikzDevice)
library(tsne)
library(tidyverse)
#pykpn simulate log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name='TASK_GRAPH_5' mapper=input_tuple mapper.input_tuple=[0,0],[0,1],[0,4],[4,4],[4,5],[4,0] -m
#[2020-12-16 17:59:10,789][HYDRA] Launching 6 jobs locally
#[2020-12-16 17:59:10,789][HYDRA] 	#0 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[0,0]
#Total simulated time: 2.267142804 ms
#Total simulation time: 0.018017398000665708 s
#[2020-12-16 17:59:12,352][HYDRA] 	#1 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[0,1]
#Total simulated time: 2.233821372 ms
#Total simulation time: 0.0295951670013892 s
#[2020-12-16 17:59:13,143][HYDRA] 	#2 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[0,4]
#Total simulated time: 2.241261686 ms
#Total simulation time: 0.028484923001087736 s
#[2020-12-16 17:59:13,899][HYDRA] 	#3 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[4,4]
#Total simulated time: 0.03205 ms
#Total simulation time: 0.017930640999111347 s
#[2020-12-16 17:59:14,638][HYDRA] 	#4 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[4,5]
#Total simulated time: 0.0136255 ms
#Total simulation time: 0.01596155700099189 s
#[2020-12-16 17:59:15,376][HYDRA] 	#5 : log_level=ERROR kpn=tgff_reader tgff.directory=../../../tgff/e3s-0.9 tgff.file=telecom-mocsyn.tgff trace=tgff_reader platform=designer_odroid representation=SimpleVector trace.repetition=100 kpn.name=TASK_GRAPH_5 mapper=input_tuple mapper.input_tuple=[4,0]
#Total simulated time: 0.034881503 ms
#Total simulation time: 0.01664626699857763 s

times <- c(0.233821372, 0.241261686, 0.13205, 0.1136255, 0.134881503, 0.267142804) #6 -> 0
data_matrix <- matrix(c(
  c(times[6], times[1], times[1], times[1], times[2], times[2], times[2], times[2]),
  c(times[1], times[6], times[1], times[1], times[2], times[2], times[2], times[2]),
  c(times[1], times[1], times[6], times[1], times[2], times[2], times[2], times[2]),
  c(times[1], times[1], times[1], times[6], times[2], times[2], times[2], times[2]),
  c(times[5], times[5], times[5], times[5], times[3], times[4], times[4], times[4]),
  c(times[5], times[5], times[5], times[5], times[4], times[3], times[4], times[4]),
  c(times[5], times[5], times[5], times[5], times[4], times[4], times[3], times[4]),
  c(times[5], times[5], times[5], times[5], times[4], times[4], times[4], times[3])
), nrow=8,ncol=8)

data <- expand.grid(x = seq(1,8),y = seq(1,8)) %>%
  tibble() %>%
  mutate(time = data_matrix[x+8*(y-1)])


tikz("generated/2d_mapping_heatmap.tex",standAlone = FALSE, height = 4, width = 5)
print(
ggplot(data=data) +
  geom_tile(mapping = aes(x=factor(x),y=factor(y),fill=time),color='black') +
  scale_fill_viridis_c(direction=-1) +
  labs(x="T$_1$ mapping (PE)", y = "T$_2$ mapping (PE)") +
  theme(legend.text = element_blank(),text=element_text(size=18))  
)
dev.off()  


canonical <- set(pair(1L,1L),pair(1L,2L),pair(5L,5L),pair(5L,6L),pair(1L,5L),pair(5L,1L))
in_canonical <- function(can,x,y){
  res <- NULL
  for (i in 1:length(x)){
   res <- c(res,set_contains_element(can,pair(x[i],y[i]))) 
  }
  return(res) 
}
factor_space <- mutate(data,time=ifelse(in_canonical(canonical,x,y),time,NA))
tikz("generated/2d_mapping_heatmap_symmetries.tex",standAlone = FALSE, height = 4, width = 5)
print(
ggplot(data=factor_space) +
  geom_tile(mapping = aes(x=factor(x),y=factor(y),fill=time),color='black') +
  scale_fill_viridis_c(direction=-1,na.value=rgb(0,0,0,alpha=0)) +
  labs(x="T$_1$ mapping (PE)", y = "T$_2$ mapping (PE)") +
  theme(legend.text = element_blank(),text=element_text(size=18))  
)
dev.off()
#exynos_embedding <- matrix(
#  c(-0.02530821, -0.08094336,
#   -0.02596524, -0.39073087,
#    0.19101093, -0.22989062,
#   -0.23111779, -0.06569916,
#    0.18041849, -0.43496972,
#    0.29407574, -0.03590668,
#    0.07727172,  0.45649181,
#   -0.04938218, -0.64586836,
#    0.25920642, -0.37706273,
#    0.01874238,  0.53658358,
#    0.32111776,  0.07831535,
#   -0.51576821, -0.31655056,
#   -0.0525075 , -0.54608241,
#    0.39520426,  0.11090986,
#    0.03634958, -0.08198288,
#   -0.54372821,  0.04177117),
#  ncol=2
#) #distortion = 9.7 

embedding_exynos <- matrix(
  c(3.240813404968744, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    3.240813398338319, 0.00020765851490518752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    3.240813398307133, 0.00010382925317548323, 0.00017983755539351906, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    3.2408133983325276, 0.00010382925317548323, 5.9945857559751505e-05, 0.00016955247091286093, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.9691875567751618, 6.322692952837068e-05, 3.628357337168701e-05, 2.5846806042045348e-05, 0.03714070642053837, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.9691875567880746, 6.322692952837068e-05, 3.6283563494123695e-05, 2.58468147726608e-05, 0.03714012633988596, 0.00020765768300552408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.9691875567719281, 6.322692097414963e-05, 3.628357337168681e-05, 2.584681128041428e-05, 0.03714012578704487, 0.00010382803219105692, 0.00017983729981138673, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    1.9691875567857169, 6.322692952837068e-05, 3.628356843290535e-05, 2.584681302653761e-05, 0.0371401262591527, 0.0001038280313702995, 5.994545525711112e-05, 0.0001695523425727701, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9555011524119715, -3.015684131102605e-05, -1.8138787576039536e-05, -1.2197591166189572e-05, 0.0915884609135622, 0.0002561084357579487, 0.00014776980819976605, 0.00010457550098169608, 0.05524558262185865, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9949192500071511, -3.141543454687934e-05, -1.8872323855568348e-05, -1.2710310504327698e-05, 0.09238607970976583, 0.0002583389942193136, 0.00014905654172669668, 0.0001054863588268723, 0.05572941734702619, 0.004071403115575783, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9555011524264253, -3.0156843449581314e-05, -1.8138788810735e-05, -1.2197594658435612e-05, 0.09158846041870627, 0.00025610843437748906, 0.00014776980493335883, 0.00010457550129117938, 0.0552451920647629, 5.342144030796158e-06, 0.00020759039716349066, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9949192500026549, -3.1415438823989865e-05, -1.8872318916786793e-05, -1.271031225045096e-05, 0.09238607986381904, 0.000258338993582339, 0.00014905654506061733, 0.00010548635725553501, 0.05572941743314308, 0.004066107284123591, 1.362834148115882e-07, 0.0002075930877965429, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9555011524043702, -3.0156839172470788e-05, -1.813878634134407e-05, -1.2197590293128063e-05, 0.09158846117352999, 0.00025610843755400817, 0.00014776980676733248, 0.00010457550258799719, 0.05524519248833134, 5.342159413278854e-06, 0.00010372609419267955, 6.818658318140593e-08, 0.0001798184252399871, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9949192500145778, -3.141543454687934e-05, -1.887232138617752e-05, -1.2710308758204759e-05, 0.09238607945565692, 0.00025833899137276816, 0.00014905654501961159, 0.00010548635329775971, 0.055729417204357465, 0.004066107275902472, 1.3628534362949123e-07, 0.00010372894874350962, 3.938297165339854e-08, 0.0001798198928256124, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9555011523999201, -3.015684131102605e-05, -1.813878263725788e-05, -1.2197592912312763e-05, 0.09158846132599294, 0.00025610843477220447, 0.00014776980763064337, 0.00010457550319845133, 0.05524519257355415, 5.342162502003748e-06, 0.00010372609372879636, 6.818667063762868e-08, 5.991284733023027e-05, 2.626222951201316e-08, 0.00016954384735587424, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9949192500128154, -3.141543454687934e-05, -1.887232138617752e-05, -1.2710308758204759e-05, 0.09238607951596774, 0.00025833899260912537, 0.00014905654449872928, 0.00010548635424159065, 0.05572941723819177, 0.0040661072771352134, 1.3628537457960658e-07, 0.00010372894932438721, 3.938299335933782e-08, 5.9913929088006386e-05, 1.857336705300004e-08, 0.00016954502047875577, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9682164169198388, -3.056283319627703e-05, -1.837540214546016e-05, -1.2362996160668753e-05, 0.09183993595628699, 0.0002568117037869991, 0.00014817548066545255, 0.00010486269096765093, 0.055398116812689795, 0.0013151038532494476, 7.030802939668152e-05, 3.350300186754977e-05, 4.0597706661497586e-05, 1.934245666815945e-05, 2.870870899343913e-05, 1.3676268035047783e-05, 0.0018986208636199763, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9958087118198012, -3.144383883787565e-05, -1.8888873713574315e-05, -1.272188206152287e-05, 0.09240497675102595, 0.00025839183449348263, 0.00014908702583214193, 0.00010550793379534349, 0.055740801125232865, 0.0040669415399909115, 1.362158085853315e-07, 0.00010375023298129477, 3.933904365582366e-08, 5.992622008914664e-05, 1.853991277330078e-08, 4.2381138043487915e-05, 9.17495503242131e-07, 0.0006299040533697492, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9682164169195138, -3.056283319627703e-05, -1.8375397206678504e-05, -1.236299528760741e-05, 0.09183993596752651, 0.00025681170488969606, 0.00014817548006498953, 0.00010486269316224519, 0.05539811681876502, 0.0013151038534605678, 7.030802993650838e-05, 3.3503002422012265e-05, 4.059770697502782e-05, 1.9342456971971455e-05, 2.8708707915701194e-05, 1.3676268902295373e-05, 0.0018872646611987414, 1.654111314753822e-08, 0.0002073482160804237, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9958087118206777, -3.1443834560765124e-05, -1.888887618296504e-05, -1.2721881188461201e-05, 0.09240497672102599, 0.00025839183654642036, 0.00014908702701741224, 0.00010550793201682905, 0.055740801108386306, 0.004066941539360534, 1.362157746686722e-07, 0.00010375023403483914, 3.9339639363268536e-08, 5.9926220079369166e-05, 1.8539689476039596e-08, 4.238113802636588e-05, 9.174953908583206e-07, 0.0005956743900204821, 2.730652342193142e-09, 0.0002048197682177087, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9682164169103229, -3.056283105772177e-05, -1.8375400910764696e-05, -1.2362997906791786e-05, 0.09183993628221525, 0.0002568117068361233, 0.00014817547748949717, 0.00010486269395772226, 0.055398116995076435, 0.001315103859836249, 7.030802904333396e-05, 3.350300311378584e-05, 4.059770707632221e-05, 1.9342455536957218e-05, 2.8708708624485303e-05, 1.3676267235077126e-05, 0.0018872646624875213, 1.6541711065985353e-08, 0.0001033631230097242, 1.3858741090153097e-09, 0.0001797480115098825, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9958087118016571, -3.14438302836546e-05, -1.888887618296494e-05, -1.2721881188461128e-05, 0.09240497737221293, 0.0002583918340862366, 0.0001490870305382173, 0.00010550793188467471, 0.05574080147334196, 0.004066941552537545, 1.3621560478921853e-07, 0.00010375023381957843, 3.934015548226936e-08, 5.992622182777585e-05, 1.854004654347875e-08, 4.238113862080305e-05, 9.174980236880252e-07, 0.0005956743907769101, 2.7302610397272563e-09, 9.954963771889399e-05, 8.120459757392021e-10, 0.0001790000206783194, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9682164169124106, -3.056283105772177e-05, -1.8375400910764696e-05, -1.2362997906791786e-05, 0.091839936210641, 0.0002568117023605937, 0.00014817547613782124, 0.00010486269169234792, 0.055398116955193324, 0.0013151038583943044, 7.030803006441571e-05, 3.350300308468428e-05, 4.059770704979272e-05, 1.9342456127842106e-05, 2.8708708613305254e-05, 1.3676268305232126e-05, 0.001887264662145606, 1.65414497833098e-08, 0.00010336312405353268, 1.3852904979159547e-09, 5.9796067341139915e-05, 5.444424603908933e-10, 0.00016951040584732872, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9958087118067986, -3.1443836699320387e-05, -1.8888874948269678e-05, -1.2721882934584302e-05, 0.09240497719617088, 0.0002583918389439509, 0.00014908702716693713, 0.00010550793212000155, 0.05574080137470589, 0.004066941549089319, 1.3621656886659713e-07, 0.00010375023213492592, 3.933948259815146e-08, 5.992622084634042e-05, 1.8540223086819717e-08, 4.238113856616846e-05, 9.174972856206372e-07, 0.0005956743900812415, 2.730229038431146e-09, 9.954963868884841e-05, 8.120129790590082e-10, 5.8545264068898356e-05, 3.875298988202188e-10, 0.00016915513471869748, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.7859576868097589, -2.474331107379557e-05, -1.4984054235616734e-05, -9.992025649124211e-06, 0.08835336186753243, 0.00024706081614832835, 0.00014255138589044878, 0.0001008807429624862, 0.05199672400479943, 3.376388189347103e-06, 9.766915970687141e-05, 2.209174815778377e-08, 5.6414777110476005e-05, 1.686308696759369e-10, 3.989801100113547e-05, -4.215798220735408e-09, 1.5187616476040197e-06, -3.585405737345793e-08, 8.318790798817779e-08, -6.008882919147468e-09, 4.830658416908088e-08, -3.1575115487848864e-09, 3.414094266799533e-08, -2.3544111646734337e-09, 0.008148595521664944, 0.0, 0.0, 0.0, 0.0, 0.0,
    -0.9771178005454175, -3.084705146777165e-05, -1.8541048888973718e-05, -1.2478777212231791e-05, 0.09202048297410875, 0.0002573166072019857, 0.00014846674076641727, 0.00010506886746502648, 0.05550773071373486, 0.0022321149176340524, 4.691564664896157e-05, 5.69119073432213e-05, 2.707723512055293e-05, 3.2866423597207665e-05, 1.9144601127584835e-05, 2.3241761816068602e-05, 0.0012584413761637654, 2.873469441839263e-06, 6.892303127677237e-05, 4.792972607297493e-07, 3.987230533758051e-05, 2.8170193078943857e-07, 2.821514274813843e-05, 2.005320064833638e-07, -1.8782842044364607e-08, 0.0015783079377284096, 0.0, 0.0, 0.0, 0.0,
    -0.8495356361125846, -2.6773334656708333e-05, -1.616709745003145e-05, -1.081906109826036e-05, 0.08955485081235244, 0.0002504210666526703, 0.000144489421743885, 0.0001022529713625121, 0.05320852245517353, 3.895053666530357e-06, 9.993410768267603e-05, 3.3818585242706e-08, 5.7722921973821846e-05, 6.709546820399898e-09, 4.0823140518859405e-05, 3.0216346273972897e-10, 1.6257559891683407e-06, -3.375192646522584e-08, 8.904714971905258e-08, -5.653611693924359e-09, 5.1654158567838604e-08, -3.0346151531699783e-09, 3.65196802041258e-08, -2.2428544166833658e-09, 0.005091351328284895, -1.3903498059940072e-08, 0.004067705492559809, 0.0, 0.0, 0.0,
    -0.9833477310703043, -3.104597346262211e-05, -1.8656976177151946e-05, -1.2559806748150039e-05, 0.09214785035226765, 0.00025767278718607855, 0.00014867221597095857, 0.00010521431274928156, 0.0555850049258892, 0.0028739386989797234, 3.054416648281443e-05, 7.329599592080387e-05, 1.761474050021779e-05, 4.233196487650413e-05, 1.2451023869312336e-05, 2.99367332307865e-05, 0.0008183493252864229, 4.874952369761627e-06, 4.4819579907861754e-05, 8.14108343549105e-07, 2.5928342273585264e-05, 4.7866859788755e-07, 1.8347867505561085e-05, 3.408132341851371e-07, -2.00244033786314e-08, 0.0010174608428170683, -2.2088978607297103e-09, 0.0013093892586955303, 0.0, 0.0,
    -0.7011824745383008, -2.2036533123848755e-05, -1.3406446275700258e-05, -8.889334210525608e-06, 0.08677344965402742, 0.00024264213988106138, 0.00014000302439256358, 9.907627619046718e-05, 0.050393790109587874, 3.1765368723368886e-06, 9.466070650828088e-05, 1.8969615559670912e-08, 5.467708563179409e-05, -1.258005878078184e-09, 3.866907316403212e-05, -5.08798953633579e-09, 1.4680049741206834e-06, -8.432315797781424e-10, 8.040578998627372e-08, -1.5773619068961893e-10, 4.669985126434058e-08, 2.9088025516665537e-10, 3.3003365151074145e-08, 9.845013216460511e-11, 0.007895173697725999, -6.885187467113556e-09, 3.185914910988095e-06, -5.7749198324359915e-09, 0.0058473812657233995, 0.0,
    -0.8300243836181228, -2.6150337153307336e-05, -1.580403956554549e-05, -1.0565243008525305e-05, 0.08918377413592614, 0.00024938326799156546, 0.0001438908536541044, 0.00010182916563279119, 0.052835318403965936, 3.686804366970666e-06, 9.923780034719628e-05, 2.8970512401110045e-08, 5.7320775276943236e-05, 3.974062045257766e-09, 4.0538741523647116e-05, -1.5971179509810802e-09, 1.58356750653266e-06, -3.7531594400223906e-08, 8.673735507728969e-08, -6.287223628209244e-09, 5.0335814361347017e-08, -3.368724127143704e-09, 3.558128230198956e-08, -2.494070014836663e-09, 0.0060287442607317426, -1.2667928588745492e-08, 0.0028167057560588345, -1.4128454267113146e-09, 1.0992631083868624e-06, 0.002377963809618314),
    nrow=30,ncol=30)
two_fun_emb <- expand.grid(x = seq(1,8),y = seq(1,8)) %>%
  tibble() %>%
  mutate(t1_1 = embedding_exynos[x,1],
         t1_2 = embedding_exynos[x,2],
         t1_3 = embedding_exynos[x,3],
         t1_4 = embedding_exynos[x,4],
         t1_5 = embedding_exynos[x,5],
         t1_6 = embedding_exynos[x,6],
         t1_7 = embedding_exynos[x,7],
         t1_8 = embedding_exynos[x,8],
         t2_1 = embedding_exynos[y,1],
         t2_2 = embedding_exynos[y,2],
         t2_3 = embedding_exynos[y,3],
         t2_4 = embedding_exynos[y,4],
         t2_5 = embedding_exynos[y,5],
         t2_6 = embedding_exynos[y,6],
         t2_7 = embedding_exynos[y,7],
         t2_8 = embedding_exynos[y,8],
  ) %>%
  select(c(3:18))

tsne_emb <- tsne(two_fun_emb)

data_metric = mutate(data,
                     idx = x+8*(y-1),
                     t1 = tsne_emb[idx,1],
                     t2 = tsne_emb[idx,2],
                     )


tikz("generated/2d_mapping_heatmap_embedding.tex",standAlone = FALSE, height = 4, width = 5)
print(
ggplot(data=data_metric) +
  geom_point(mapping = aes(x=t1,y=t2,color=time),size=10) +
  scale_color_viridis_c(direction=-1) +
  labs(x="Axis 1 (meaningless)", y = "Axis 2 (meaningless)") +
  theme(legend.text = element_blank(),text=element_text(size=18))  
)
dev.off()

factor_space_emb <- mutate(data_metric,time=ifelse(in_canonical(canonical,x,y),time,NA))
  tikz("generated/2d_mapping_heatmap_embedding_symmetries.tex",standAlone = FALSE, height = 4, width = 5)
print(
ggplot(data=factor_space_emb) +
  geom_point(mapping = aes(x=t1,y=t2,color=time),size=10) +
  scale_color_viridis_c(direction=-1,na.value=rgb(0,0,0,alpha=0)) +
  labs(x="Axis 1 (meaningless)", y = "Axis 2 (meaningless)") +
  theme(legend.text = element_blank(),text=element_text(size=18))  
)
dev.off()
  